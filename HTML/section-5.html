<!DOCTYPE html>
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2020-10-05T19:34:44-05:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Oct 8: The Complete Solution to \(Ax=b\)</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://sagecell.sagemath.org/embedded_sagecell.js"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']]
    },
    asciimath2jax: {
        ignoreClass: ".*",
        processClass: "has_am"
    },
    jax: ["input/AsciiMath"],
    extensions: ["asciimath2jax.js"],
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://pretextbook.org/js/lib/mathjaxknowl.js", "AMScd.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none", useLabelIds: true, },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML-full"></script><script>$(function () {
    // Make *any* div with class 'sagecell-sage' an executable Sage cell
    // Their results will be linked, only within language type
    sagecell.makeSagecell({inputLocation: 'div.sagecell-sage',
                           linked: true,
                           languages: ['sage'],
                           evalButtonText: 'Evaluate (Sage)'});
});
</script><script>(function() {
  var cx = '017464805646507420634:llcu9bfj13p';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
</script><script src="https://pretextbook.org/js/lib/jquery.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.13/pretext.js"></script><script src="https://pretextbook.org/js/0.13/pretext_add_on.js"></script><script src="https://pretextbook.org/js/lib/knowl.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/pretext.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/banner_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/toc_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/knowls_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/style_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/colors_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/setcolors.css" rel="stylesheet" type="text/css">
<!-- 2019-10-12: Temporary - CSS file for experiments with styling --><link href="developer.css" rel="stylesheet" type="text/css">
</head>
<body class="mathbook-book has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div class="hidden-content" style="display:none">\(\renewcommand{\labelitemi}{$\diamond$}
\def\arraystretch{1.5}
\newcommand{\contentsfinish}{}
\newcommand{\separator}{\begin{center}\rule{\columnwidth}{\arrayrulewidth}\end{center}}
\newcommand{\tosay}[1]{\begin{center}\text{\fbox{\scriptsize{#1}}}\end{center}}
\renewcommand{\cftsecfont}{}
\renewcommand{\cftsecpagefont}{}
\renewcommand{\descriptionlabel}[1]{\hspace{\labelsep}\smallcaps{#1}}
\def\oldequation{\equation}
\def\endoldequation{\endequation}
\newcommand{\nl}{
}
\newcommand{\runin}[1]{\textls[50]{\otherscshape #1}}
\renewcommand{\sectionmark}[1]{}
\renewcommand{\subsectionmark}[1]{}
\renewcommand{\sectionmark}[1]{\markboth{{\thesection}.\ \smallcaps{#1}}{\thesection.\ \smallcaps{#1}}}
\renewcommand{\subsectionmark}[1]{}
\renewcommand{\sectionmark}[1]{\markboth{{\scriptsize\thesection}.\ \smallcaps{#1}}{}}
\renewcommand{\subsectionmark}[1]{}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\headrulewidth}{0.5pt}
\newcommand{\makedefaultsection}[2][true]{
}
\newcommand{\timestamp}{{\color{red}Last updated: {\currenttime\ (UTC), \today}}}
\renewcommand{\le}{\leqslant}
\renewcommand{\leq}{\leqslant}
\renewcommand{\geq}{\geqslant}
\renewcommand{\ge}{\geqslant}
\newcommand{\ideal}[1]{\left\langle\, #1 \,\right\rangle}
\newcommand{\subgp}[1]{\left\langle\, #1 \,\right\rangle}
\def\p{\varphi}
\def\isomorphic{\cong}
\def\Gal{\text{Gal}}
\def\im{\text{im}}
\def\normal{\vartriangleleft}
\renewcommand{\qedsymbol}{$\checkmark$}
\def\lcm{{\text{lcm}\,}}
\newcommand{\q}[1]{{\color{red} {#1}}}
\newcommand{\startimportant}[1]{\end{[{Hint:} #1]\end}}
\renewcommand{\textcircled}[1]{\tikz[baseline=(char.base)]{\node[shape=circle,draw,inner sep=2pt,color=red] (char) {#1};}}
\newcommand{\crossout}[1]{\tikz[baseline=(char.base)]{\node[mynode, cross out,draw] (char) {#1};}}
\newcommand{\set}[1]{\left\{ {#1} \right\}}
\newcommand{\setof}[2]{{\left\{#1\,\colon\,#2\right\}}}
\def\C{{\mathbb C}}
\def\Z{{\mathbb Z}}
\def\bF{{\mathbb F}}
\def\Q{{\mathbb Q}}
\def\N{{\mathbb N}}
\def\R{{\mathbb R}}
\newcommand{\h}[1]{{\textbf{#1}}}
\def\presnotes{}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="book-1.html"><span class="title">Linear Algebra Activities</span></a></h1>
<p class="byline">Dr. Mike Janssen</p>
</div>
<div class="searchwrapper" role="search"><div class="gcse-search"></div></div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3"><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="Sec-TranspSymPerm.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="Chap-Week7.html" title="Up">Up</a><span id="nextbutton" class="next-button button toolbar-item disabled">Next</span></span></div>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="Sec-TranspSymPerm.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="Chap-Week7.html" title="Up">Up</a><span class="next-button button toolbar-item disabled">Next</span>
</div>
</div></nav></header><div class="page">
<div id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><ul>
<li class="link frontmatter">
<a href="frontmatter-1.html" data-scroll="frontmatter-1"><span class="title">Front Matter</span></a><ul>
<li><a href="colophon-1.html" data-scroll="colophon-1">Colophon</a></li>
<li><a href="acknowledgement-1.html" data-scroll="acknowledgement-1">Acknowledgements</a></li>
</ul>
</li>
<li class="link">
<a href="Chap-Week5.html" data-scroll="Chap-Week5"><span class="codenumber">1</span> <span class="title">Week 5: Matrices</span></a><ul><li><a href="Sec-LUFactorization.html" data-scroll="Sec-LUFactorization">Sept. 24: The \(LU\) Factorization</a></li></ul>
</li>
<li class="link">
<a href="Chap-Week6.html" data-scroll="Chap-Week6"><span class="codenumber">2</span> <span class="title">Week 6: Matrices and Vector Spaces</span></a><ul>
<li><a href="Sec-TranspSymPerm.html" data-scroll="Sec-TranspSymPerm">Sept. 29: Transposes, Symmetry, and Permutations</a></li>
<li><a href="Sec-Spaces-of-Vectors.html" data-scroll="Sec-Spaces-of-Vectors">Oct. 1: Spaces of Vectors</a></li>
</ul>
</li>
<li class="link">
<a href="Chap-Week7.html" data-scroll="Chap-Week7"><span class="codenumber">3</span> <span class="title">Week 7: Nullspace and solving \(Ax=b\)</span></a><ul>
<li><a href="Sec-TranspSymPerm.html" data-scroll="Sec-TranspSymPerm">Oct 6: Solving \(Ax=0\)</a></li>
<li><a href="section-5.html" data-scroll="section-5" class="active">Oct 8: The Complete Solution to \(Ax=b\)</a></li>
</ul>
</li>
</ul></nav><div class="extras"><nav><a class="mathbook-link" href="https://pretextbook.org">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="pretext-content"><section class="section" id="section-5"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">3.2</span> <span class="title">Oct 8: The Complete Solution to \(Ax=b\)</span>
</h2>
<section class="subsection" id="subsection-10"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">3.2.1</span> <span class="title">SageMath and Solving General Systems</span>
</h3>
<p id="p-32">SageMath has many built-in methods for solving systems of linear equations. We will investigate three common ones with a single example considered several times.</p>
<div class="sagecell-sage" id="sage-39"><script type="text/x-sage">A = matrix(QQ, 3,4, [1,0,2,3, 1,3,2,0, 2,0,4,9])
b = vector([2,5,10])
print A
print b
</script></div>
<section class="subsubsection" id="subsubsection-1"><h4 class="heading hide-type">
<span class="type">Subsubsection</span> <span class="codenumber">3.2.1.1</span> <span class="title">Method One: RREF and the Nullspace</span>
</h4>
<p id="p-33">First we find a particular solution.</p>
<div class="sagecell-sage" id="sage-40"><script type="text/x-sage">X = A.augment(b, subdivide=True).rref()
X  # this subdivide thing is pretty handy!
</script></div>
<p id="p-34">This clearly has three pivots, and all belong in the original matrix. So there will be a solution. We pull out the particular solution.</p>
<div class="sagecell-sage" id="sage-41"><script type="text/x-sage">xp = vector([-4, 3, 0, 2])
xp
</script></div>
<p id="p-35">Since we typed that in by hand, we should check our work.</p>
<div class="sagecell-sage" id="sage-42"><script type="text/x-sage">A*xp == b
</script></div>
<p id="p-36">Now we need to find the nullspace and the special solutions.</p>
<div class="sagecell-sage" id="sage-43"><script type="text/x-sage">A.right_kernel()
</script></div>
<p id="p-37">The basis has only one row, so there is only one special solution. This matches our expectation. Our system is \(3\times 4\) and has rank \(3\text{.}\) So there is only one free column, and hence only one special solution.</p>
<div class="sagecell-sage" id="sage-44"><script type="text/x-sage">s1 = vector([-2, 0, 1, 0])
A*s1 == 0
</script></div>
<p id="p-38">Now we can check the “general solution”.</p>
<div class="sagecell-sage" id="sage-45"><script type="text/x-sage">t = var('t')
gensol = xp + t * s1
gensol
</script></div>
<div class="sagecell-sage" id="sage-46"><script type="text/x-sage">A*gensol == b
</script></div></section><section class="subsubsection" id="subsubsection-2"><h4 class="heading hide-type">
<span class="type">Subsubsection</span> <span class="codenumber">3.2.1.2</span> <span class="title">Method Two: A SageMath built-in</span>
</h4>
<p id="p-39">SageMath has a built-in method that looks like “Matrix division”. Here we “left divide” by the matrix. This is odd notation, and is just something SageMath allows.</p>
<div class="sagecell-sage" id="sage-47"><script type="text/x-sage">A\b
</script></div>
<p id="p-40">It is weird, but this works even if <code class="code-inline tex2jax_ignore">A</code> is not invertible, like now.</p>
<div class="sagecell-sage" id="sage-48"><script type="text/x-sage">A.inverse()*b
</script></div>
<p id="p-41">The downside to this particular method is that in only gives you one particular solution. It does not produce the complete solution. You have to do that bit for yourself, maybe like the above.</p></section><section class="subsubsection" id="subsubsection-3"><h4 class="heading hide-type">
<span class="type">Subsubsection</span> <span class="codenumber">3.2.1.3</span> <span class="title">Method Three: Another SageMath Built-in</span>
</h4>
<p id="p-42">Finally, SageMath will also try to solve the system if you apply the <code class="code-inline tex2jax_ignore">.solve_right()</code> method to <code class="code-inline tex2jax_ignore">A</code>. You have to supply the vector <code class="code-inline tex2jax_ignore">b</code> as an argument to the command.</p>
<div class="sagecell-sage" id="sage-49"><script type="text/x-sage">A.solve_right(b)
</script></div>
<p id="p-43">Again, this only pulls out a single particular solution. It is up to you to figure out the rest.</p></section></section></section></div></main>
</div>
</body>
</html>
